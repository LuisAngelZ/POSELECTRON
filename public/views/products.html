<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gesti√≥n de Productos - Sistema POS</title>
  <link rel="stylesheet" href="/css/product.css">
</head>
<body>
    <div class="app-container">
        <main class="main-content" id="mainContent">
            <div class="top-bar">
                <div class="top-bar-left">
                    <button class="sidebar-toggle" id="sidebarToggle">
                        <span id="toggleIcon">‚ò∞</span>
                    </button>
                    <h1 class="page-title">
                        üì¶ Gesti√≥n de Productos
                    </h1>
                </div>
                <div class="breadcrumb">
                    <span>üè†</span>
                    <span>Sistema POS</span>
                    <span>‚Ä∫</span>
                    <span>Productos</span>
                </div>
            </div>

            <div class="content-area">
                <!-- Tab Navigation -->
                <div class="tab-header">
                    <button class="tab-btn active" onclick="switchTab('products')">
                        üìã Productos
                    </button>
                    <button class="tab-btn" onclick="switchTab('categories')">
                        üè∑Ô∏è Categor√≠as
                    </button>
                    <button class="tab-btn" onclick="switchTab('create-product')">
                        ‚ûï Crear Producto
                    </button>
                    <button class="tab-btn" onclick="switchTab('create-category')">
                        ‚ûï Nueva Categor√≠a
                    </button>
                </div>

                <!-- TAB: Lista de Productos -->
                <div id="productsTab" class="tab-content active">
                    <div class="products-header">
                        <div>
                            <h2 style="font-size: 1.5rem; font-weight: 700; color: #1a1d29; margin-bottom: 0.5rem;">
                                Inventario de Productos
                            </h2>
                            <p style="color: #6b7280;">Administra tu cat√°logo de productos</p>
                        </div>
                        
                        <div class="search-section">
                            <input type="text" id="searchInput" class="search-input" placeholder="Buscar productos...">
                        </div>
                    </div>

                    <div class="filter-section">
                        <label for="categoryFilter">Filtrar por categor√≠a:</label>
                        <select id="categoryFilter" class="filter-select" onchange="filterByCategory()">
                            <option value="">Todas las categor√≠as</option>
                        </select>
                        
                        <label for="sortBy">Ordenar por:</label>
                        <select id="sortBy" class="filter-select" onchange="sortProducts()">
                            <option value="name">Nombre</option>
                            <option value="price">Precio</option>
                            <option value="category">Categor√≠a</option>
                        </select>
                    </div>

                    <div id="productsContainer"></div>
                </div>

                <!-- TAB: Lista de Categor√≠as -->
                <div id="categoriesTab" class="tab-content">
                    <div class="products-header">
                        <div>
                            <h2 style="font-size: 1.5rem; font-weight: 700; color: #1a1d29; margin-bottom: 0.5rem;">
                                Gesti√≥n de Categor√≠as
                            </h2>
                            <p style="color: #6b7280;">Organiza y administra las categor√≠as de productos</p>
                        </div>
                        
                        <div class="search-section">
                            <input type="text" id="searchCategoriesInput" class="search-input" placeholder="Buscar categor√≠as...">
                        </div>
                    </div>

                    <div id="categoriesContainer"></div>
                </div>
                <!-- TAB: Crear Producto -->
                <div id="create-productTab" class="tab-content">
                    <div class="form-card">
                        <div class="form-header">
                            <h2 id="formTitle">Nuevo Producto</h2>
                            <p id="formDescription">Completa la informaci√≥n para agregar un producto al inventario</p>
                        </div>

                        <form id="productForm">
                            <input type="hidden" id="editingProductId">
                            
                            <div class="form-section">
                                <h3 class="section-title">
                                    <span>üìù</span>
                                    Informaci√≥n B√°sica
                                </h3>
                                
                                <div class="form-grid">
                                    <div class="form-group">
                                        <label for="productName" class="form-label required">Nombre del Producto</label>
                                        <input type="text" id="productName" name="name" class="form-input" 
                                               placeholder="Ej: Pizza Margherita" required maxlength="100">
                                        <div class="input-helper">M√°ximo 100 caracteres</div>
                                    </div>

                                    <div class="form-group">
                                        <label for="productPrice" class="form-label required">Precio</label>
                                        <div class="price-input-wrapper">
                                            <span class="price-symbol">Bs</span>
                                            <input type="number" id="productPrice" name="price" class="form-input price-input" 
                                                   placeholder="0.00" step="0.01" min="0" required>
                                        </div>
                                        <div class="input-helper">Precio en bolivianos (Bs.)</div>
                                    </div>
                                </div>

                                <div class="form-group full-width">
                                    <label for="productDescription" class="form-label">Descripci√≥n</label>
                                    <textarea id="productDescription" name="description" class="form-input form-textarea" 
                                              placeholder="Descripci√≥n detallada del producto..." maxlength="500"></textarea>
                                    <div class="input-helper">Opcional - M√°ximo 500 caracteres</div>
                                </div>

                                <div class="form-grid">

<div class="form-group full-width">
  <label for="productImage" class="form-label">Imagen del Producto</label>
  <input type="file" id="productImage" name="image" class="form-input" accept="image/png,image/jpeg,image/webp">
  <div class="input-helper">Opcional - JPG/PNG/WebP m√°x. 2MB</div>

  <!-- Preview opcional -->
  <img id="productImagePreview" style="display:none;margin-top:10px;max-height:160px;border-radius:12px;object-fit:cover;">
</div>
                                </div>
                            </div>

                            <div class="form-section">
                                <h3 class="section-title">
                                    <span>üè∑Ô∏è</span>
                                    Categor√≠a
                                </h3>
                                
                                <div class="form-group">
                                    <label for="productCategory" class="form-label required">Seleccionar Categor√≠a</label>
                                    <select id="productCategory" name="category_id" class="form-select" required>
                                        <option value="">Seleccionar categor√≠a</option>
                                    </select>
                                </div>
                            </div>

                            <div class="button-group">
                                <button type="button" class="btn btn-secondary" onclick="cancelForm()">
                                    <span>‚úñ</span>
                                    Cancelar
                                </button>
                                <button type="submit" class="btn btn-primary" id="submitBtn">
                                    <span>üíæ</span>
                                    <span id="submitBtnText">Crear Producto</span>
                                </button>
                            </div>
                        </form>
                    </div>
                </div>

                <!-- TAB: Crear Categor√≠a -->
                <div id="create-categoryTab" class="tab-content">
                    <div class="form-card">
                        <div class="form-header">
                            <h2 id="categoryFormTitle">Nueva Categor√≠a</h2>
                            <p id="categoryFormDescription">Completa la informaci√≥n para crear una nueva categor√≠a</p>
                        </div>

                        <form id="categoryForm">
                            <input type="hidden" id="editingCategoryId">
                            
                            <div class="form-section">
                                <h3 class="section-title">
                                    <span>üè∑Ô∏è</span>
                                    Informaci√≥n de la Categor√≠a
                                </h3>
                                
                                <div class="form-group">
                                    <label for="categoryName" class="form-label required">Nombre de la Categor√≠a</label>
                                    <input type="text" id="categoryName" name="name" class="form-input" 
                                           placeholder="Ej: Bebidas, Comidas, Postres..." required maxlength="100">
                                    <div class="input-helper">M√°ximo 100 caracteres</div>
                                </div>

                                <div class="form-group">
                                    <label for="categoryDescription" class="form-label">Descripci√≥n</label>
                                    <textarea id="categoryDescription" name="description" class="form-input form-textarea" 
                                              placeholder="Descripci√≥n detallada de la categor√≠a..." maxlength="255"></textarea>
                                    <div class="input-helper">Opcional - M√°ximo 255 caracteres</div>
                                </div>
                            </div>

                            <div class="button-group">
                                <button type="button" class="btn btn-secondary" onclick="cancelCategoryForm()">
                                    <span>‚úñ</span>
                                    Cancelar
                                </button>
                                <button type="submit" class="btn btn-primary" id="categorySubmitBtn">
                                    <span>üíæ</span>
                                    <span id="categorySubmitBtnText">Crear Categor√≠a</span>
                                </button>
                            </div>
                        </form>
                    </div>
                </div>
            </div>
        </main>
    </div>
    <!-- Modal para editar producto -->
    <div id="productModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">Editar Producto</h2>
                <button class="modal-close" onclick="closeModal('productModal')">&times;</button>
            </div>
            
            <form id="modalProductForm">
                <input type="hidden" id="modalProductId">
                
                <div class="form-group">
                    <label for="modalProductName" class="form-label required">Nombre del Producto</label>
                    <input type="text" id="modalProductName" name="name" class="form-input" 
                           placeholder="Nombre del producto" required maxlength="100">
                </div>

                <div class="form-group">
                    <label for="modalProductPrice" class="form-label required">Precio (Bs.)</label>
                    <input type="number" id="modalProductPrice" name="price" class="form-input" 
                           placeholder="0.00" step="0.01" min="0" required>
                </div>

                <div class="form-group">
                    <label for="modalProductCategory" class="form-label required">Categor√≠a</label>
                    <select id="modalProductCategory" name="category_id" class="form-select" required>
                        <option value="">Seleccionar categor√≠a</option>
                    </select>
                </div>

                <div class="form-group">
                    <label for="modalProductDescription" class="form-label">Descripci√≥n</label>
                    <textarea id="modalProductDescription" name="description" class="form-input form-textarea" 
                              placeholder="Descripci√≥n del producto..." maxlength="500"></textarea>
                </div>

                <div class="form-group">
    <label for="modalProductImage" class="form-label">Cambiar Imagen</label>
    <input type="file" id="modalProductImage" name="image" class="form-input" 
           accept="image/*" onchange="previewModalImage(this)">
    <div class="input-helper">Opcional - Selecciona una nueva imagen</div>
    <div id="modalImagePreview" class="image-preview">
        <img id="modalPreviewImg" src="" alt="Imagen actual" style="max-width: 200px; max-height: 150px; object-fit: cover; border-radius: 8px; margin-top: 10px; display: none;">
    </div>
</div>

                <div class="modal-actions">
                    <button type="button" class="btn btn-secondary" onclick="closeModal('productModal')">
                        Cancelar
                    </button>
                    <button type="submit" class="btn btn-primary" id="modalSubmitBtn">
                        Actualizar Producto
                    </button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal para editar categor√≠a -->
    <div id="categoryModal" class="modal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 class="modal-title">Editar Categor√≠a</h2>
                <button class="modal-close" onclick="closeModal('categoryModal')">&times;</button>
            </div>
            
            <form id="modalCategoryForm">
                <input type="hidden" id="modalCategoryId">
                
                <div class="form-group">
                    <label for="modalCategoryName" class="form-label required">Nombre de la Categor√≠a</label>
                    <input type="text" id="modalCategoryName" name="name" class="form-input" 
                           placeholder="Nombre de la categor√≠a" required maxlength="100">
                </div>

                <div class="form-group">
                    <label for="modalCategoryDescription" class="form-label">Descripci√≥n</label>
                    <textarea id="modalCategoryDescription" name="description" class="form-input form-textarea" 
                              placeholder="Descripci√≥n de la categor√≠a..." maxlength="255"></textarea>
                </div>

                <div class="modal-actions">
                    <button type="button" class="btn btn-secondary" onclick="closeModal('categoryModal')">
                        Cancelar
                    </button>
                    <button type="submit" class="btn btn-primary" id="modalCategorySubmitBtn">
                        Actualizar Categor√≠a
                    </button>
                </div>
            </form>
        </div>
    </div>
    <script src="/js/products.js" defer></script>
    <!-- Cargar sidebar universal -->
    <script src="/js/sidebar.js" defer></script>
</body>
</html>